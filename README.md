# 腾讯文档导出PDF-极速版（油猴脚本）
一款极简逻辑、极致提速的腾讯文档PDF导出油猴脚本，修复导出PDF黑背景问题，去除冗余等待逻辑，大幅提升导出效率。

## 功能介绍
可通过该脚本在腾讯文档网页端一键导出PDF，核心优势如下：
- **极速导出**：优化核心等待参数，相比常规脚本减少50%+的等待时间
- **白背景修复**：解决导出PDF出现黑背景的问题
- **极简逻辑**：无冗余代码和无效等待，仅保留核心导出流程
- **章节自动采集**：智能识别文档大纲章节，完整采集所有内容

## 安装步骤
### 1. 安装油猴插件
首先在浏览器中安装 Tampermonkey（油猴）插件，支持 Chrome/Edge/Firefox 等主流浏览器：
- Chrome/Edge：[Chrome 网上应用店 - Tampermonkey](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)
- Firefox：[Firefox 附加组件 - Tampermonkey](https://addons.mozilla.org/zh-CN/firefox/addon/tampermonkey/)

### 2. 安装脚本
1. 点击浏览器右上角 Tampermonkey 图标，选择「新建脚本」；
2. 清空默认代码，复制本脚本全部代码粘贴；
3. 按下 `Ctrl+S` 保存，脚本自动生效。

## 使用说明
1. 打开需要导出的腾讯文档（网页端地址：`https://docs.qq.com/*`）；
2. 页面加载完成后，右上角会出现「⚡ 极速导出PDF」按钮；
3. 点击按钮，脚本开始自动采集内容（按钮显示「捕获中...」）；
4. 采集完成后，PDF文件会自动下载（文件名默认使用文档标题）。

## 核心特性
| 特性 | 详细说明 |
|------|----------|
| 极致提速 | 优化章节等待、滚动延迟、滚动步长等参数，大幅减少无意义等待 |
| 白背景修复 | 自动为Canvas填充白色背景，彻底解决导出PDF黑背景问题 |
| 大纲识别 | 智能抓取文档大纲章节，按章节完整采集内容，避免漏页 |
| 格式优化 | 使用JPEG格式导出（画质保留90%），相比PNG体积更小、速度更快 |
| 极简逻辑 | 去除冗余代码和无效检测，仅保留核心导出逻辑，运行更稳定 |

## 配置参数说明
脚本内的 `CONFIG` 常量可根据文档加载情况调整，参数含义如下：
```javascript
const CONFIG = {
    chapterWait: 2000,      // 章节切换后等待时间（ms），加载慢可调至3000
    scrollDelay: 800,       // 滚动后等待内容加载时间（ms），加载慢可调至1000
    scrollStep: 0.9,        // 单次滚动步长（可视区比例），数值越小越精细但耗时更长
    stableChecks: 4,        // 无新内容时的稳定检查轮次，调大可减少漏页
    maxScrollTime: 40000,   // 单章节最大滚动超时时间（ms），避免无限等待
};
```
## 注意事项
- 导出前请确保文档大纲已展开，否则可能无法识别章节导致漏页；
- 网络不稳定或文档内容较多时，可适当调大 chapterWait/scrollDelay 参数；
- 仅支持腾讯文档网页端（https://docs.qq.com/*），不支持移动端 / 客户端；
- 导出的 PDF 为图片格式（基于 Canvas 渲染），暂不支持文字搜索，如需可编辑 PDF 请使用官方功能；
- 若导出页数不全，可尝试调小 scrollStep（如 0.7）或调大 stableChecks（如 6）。
